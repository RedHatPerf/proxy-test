name: maxout
simulation:
  http:
    baseUrl: http://{{ proxy_host }}:{{ proxy_port }}
    sharedConnections: {{ test_shared_connections | default(100, true) }}
  phases:
  - warmup: !constantPerSec
      usersPerSec: 2000              
      duration: 20
      scenario: &scenario
        orderedSequences:
        - test:
          - sla:
              errorRate: 0.05
              meanResponseTime: 500 ms
          - httpRequest:
              method: GET
              path: {{ test_path | default("/", true) }}
          - awaitAllResponses                  
  - iterations: !constantPerSec
      startAfter: warmup
      usersPerSec:
        base:      5000
        increment: 5000
      maxIterations: 15            
      duration: 20
      # We need to set maxDuration, otherwise the scheduled request would prolong the phase
      maxDuration: 20
      maxUnfinishedSessions: 500
      scenario: *scenario
        
